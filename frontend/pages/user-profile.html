<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User Profile | Tripeaz Taxi Partners</title>
  <link rel="stylesheet" href="../css/pages/dashboard.css">
  <link rel="stylesheet" href="../css/pages/user-profile.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    body {
      background-color: #121212;
      color: #ffffff;
      margin: 0;
      padding: 0;
    }
  </style>
</head>
<body>
  <!-- Header Strip -->
  <div class="header-strip">
    <div class="strip-gradient"></div>
  </div>

  <div class="profile-page">
    <!-- Back Button -->
    <button class="back-btn" id="backBtn">‚Üê Back</button>

    <!-- Profile Header with Cover Image -->
    <div class="profile-header-section">
      <div class="cover-image" id="coverImage"></div>
      <div class="profile-header-content">
        <div class="profile-avatar-large" id="profileAvatarLarge">
          <div class="avatar-placeholder">üë§</div>
        </div>
        <div class="profile-basic-info">
          <h1 class="profile-name" id="profileName">Loading...</h1>
          <div class="location-info" id="locationInfo"></div>
          <div class="verified-badge-container" id="verifiedBadge"></div>
        </div>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="action-buttons">
      <button class="action-btn call-btn" id="callBtn">
        <span class="btn-icon">üìû</span>
        <span>Call</span>
      </button>
      <button class="action-btn whatsapp-btn" id="whatsappBtn">
        <span class="btn-icon">üí¨</span>
        <span>WhatsApp</span>
      </button>
      <button class="action-btn share-btn" id="shareBtn">
        <span class="btn-icon">üîó</span>
        <span>Share</span>
      </button>
    </div>

    <!-- User Info Card -->
    <div class="info-card">
      <div class="info-row">
        <span class="info-label">Company name:</span>
        <span class="info-value" id="companyName">-</span>
      </div>
      <div class="info-row">
        <span class="info-label">Email Id:</span>
        <span class="info-value" id="emailId">-</span>
      </div>
      <div class="info-row">
        <span class="info-label">Booking Cancelled Count:</span>
        <span class="info-value" id="cancelledCount">0</span>
      </div>
    </div>

    <!-- Rating Summary -->
    <div class="rating-summary-card">
      <div class="rating-display">
        <span class="rating-star">‚≠ê</span>
        <span class="rating-value" id="averageRating">0.0</span>
      </div>
      <div class="rating-text" id="ratingText">Based on 0 ratings & reviews</div>
      <button class="write-review-btn" id="writeReviewBtn">Write a Review</button>
    </div>

    <!-- Partner Score Section -->
    <div class="partner-score-card" id="partnerScoreCard" style="display: none;">
      <h3 class="section-title">Partner Score</h3>
      <div class="partner-score-display" id="partnerScoreDisplay">
        <div class="score-value" id="partnerScoreValue">-</div>
        <div class="score-category" id="partnerScoreCategory">-</div>
        <div class="score-description" id="partnerScoreDescription"></div>
      </div>
    </div>

    <!-- Warning Card (for < 5 ratings) -->
    <div class="warning-card" id="warningCard" style="display: none;">
      <div class="warning-icon">‚ö†Ô∏è</div>
      <div class="warning-content">
        <h3 class="warning-title">Limited Rating Information</h3>
        <p class="warning-message" id="warningMessage"></p>
      </div>
    </div>

    <!-- Rating Distribution -->
    <div class="rating-distribution-card" id="ratingDistributionCard" style="display: none;">
      <h3 class="section-title">Rating Distribution</h3>
      <div class="distribution-item">
        <span class="star-label">5 Star</span>
        <div class="distribution-bar-container">
          <div class="distribution-bar" id="bar5" style="width: 0%"></div>
        </div>
        <span class="distribution-percent" id="percent5">0%</span>
      </div>
      <div class="distribution-item">
        <span class="star-label">4 Star</span>
        <div class="distribution-bar-container">
          <div class="distribution-bar" id="bar4" style="width: 0%"></div>
        </div>
        <span class="distribution-percent" id="percent4">0%</span>
      </div>
      <div class="distribution-item">
        <span class="star-label">3 Star</span>
        <div class="distribution-bar-container">
          <div class="distribution-bar" id="bar3" style="width: 0%"></div>
        </div>
        <span class="distribution-percent" id="percent3">0%</span>
      </div>
      <div class="distribution-item">
        <span class="star-label">2 Star</span>
        <div class="distribution-bar-container">
          <div class="distribution-bar" id="bar2" style="width: 0%"></div>
        </div>
        <span class="distribution-percent" id="percent2">0%</span>
      </div>
      <div class="distribution-item">
        <span class="star-label">1 Star</span>
        <div class="distribution-bar-container">
          <div class="distribution-bar" id="bar1" style="width: 0%"></div>
        </div>
        <span class="distribution-percent" id="percent1">0%</span>
      </div>
    </div>

    <!-- About Section -->
    <div class="about-card">
      <h3 class="section-title">About</h3>
      <div class="about-item" id="experienceItem" style="display: none;">
        <span class="about-label">Experience:</span>
        <span class="about-value" id="experienceValue">-</span>
      </div>
      <div class="about-item" id="ageItem" style="display: none;">
        <span class="about-label">Age:</span>
        <span class="about-value" id="ageValue">-</span>
      </div>
      <div class="about-description" id="businessDescription" style="display: none;"></div>
    </div>

    <!-- Preferred Trips and Routes -->
    <div class="preferred-section" id="preferredTripsSection" style="display: none;">
      <h3 class="section-title">Preferred Trips and Routes</h3>
      <div class="chips-container" id="preferredTripsChips"></div>
      <div class="chips-container" id="preferredRoutesChips"></div>
    </div>

    <!-- Languages -->
    <div class="languages-section" id="languagesSection" style="display: none;">
      <h3 class="section-title">Languages</h3>
      <div class="chips-container" id="languagesChips"></div>
    </div>

    <!-- Available Vehicles -->
    <div class="vehicles-section" id="vehiclesSection" style="display: none;">
      <h3 class="section-title">Available Vehicles</h3>
      <div class="vehicles-list" id="vehiclesList"></div>
    </div>

    <!-- Reviews Section -->
    <div class="reviews-section" id="reviewsSection">
      <h3 class="section-title">Reviews & Ratings</h3>
      <div class="reviews-list" id="reviewsList">
        <div class="loading-state">
          <div class="loading-spinner"></div>
          <p>Loading reviews...</p>
        </div>
      </div>
      <!-- Pagination -->
      <div class="pagination" id="pagination" style="display: none;">
        <button class="pagination-btn" id="prevBtn">Previous</button>
        <span class="pagination-info" id="paginationInfo">Page 1 of 1</span>
        <button class="pagination-btn" id="nextBtn">Next</button>
      </div>
    </div>

    <!-- Loading State -->
    <div class="loading-state" id="loadingState">
      <div class="loading-spinner"></div>
      <p>Loading profile...</p>
    </div>

    <!-- Error State -->
    <div class="error-state" id="errorState" style="display: none;">
      <p id="errorMessage">Error loading profile</p>
    </div>
  </div>

  <!-- Write Review Modal -->
  <div class="review-modal-overlay" id="reviewModal">
    <div class="review-modal">
      <div class="review-modal-header">
        <h3>Write a Review</h3>
        <button class="close-modal-btn" id="closeReviewModal">&times;</button>
      </div>
      <form class="review-form" id="reviewForm">
        <!-- Rating Selection -->
        <div class="form-group">
          <label class="form-label">Rating *</label>
          <div class="star-rating" id="starRating">
            <span class="star" data-rating="1">‚≠ê</span>
            <span class="star" data-rating="2">‚≠ê</span>
            <span class="star" data-rating="3">‚≠ê</span>
            <span class="star" data-rating="4">‚≠ê</span>
            <span class="star" data-rating="5">‚≠ê</span>
          </div>
          <input type="hidden" id="selectedRating" name="rating" required>
          <span class="error-message" id="ratingError"></span>
        </div>

        <!-- Review Text -->
        <div class="form-group">
          <label for="reviewText" class="form-label">Your Review</label>
          <textarea
            id="reviewText"
            name="reviewText"
            class="mobile-input"
            rows="4"
            placeholder="Share your experience..."
            maxlength="500"
          ></textarea>
          <div class="char-count">
            <span id="charCount">0</span>/500
          </div>
        </div>

        <!-- Service Name -->
        <div class="form-group">
          <label for="serviceName" class="form-label">Service Name (Optional)</label>
          <input
            type="text"
            id="serviceName"
            name="serviceName"
            class="mobile-input"
            placeholder="e.g., Ana taxi service"
            maxlength="100"
          />
        </div>

        <!-- Tags -->
        <div class="form-group">
          <label class="form-label">Tags (Optional)</label>
          <div class="tags-selection">
            <label class="tag-checkbox">
              <input type="checkbox" value="Excellent behaviour">
              <span>Excellent behaviour</span>
            </label>
            <label class="tag-checkbox">
              <input type="checkbox" value="Highly recommended">
              <span>Highly recommended</span>
            </label>
            <label class="tag-checkbox">
              <input type="checkbox" value="Punctual">
              <span>Punctual</span>
            </label>
            <label class="tag-checkbox">
              <input type="checkbox" value="Safe driver">
              <span>Safe driver</span>
            </label>
            <label class="tag-checkbox">
              <input type="checkbox" value="Good communication">
              <span>Good communication</span>
            </label>
            <label class="tag-checkbox">
              <input type="checkbox" value="Clean vehicle">
              <span>Clean vehicle</span>
            </label>
          </div>
        </div>

        <!-- Error Message -->
        <div class="error-message" id="reviewFormError" style="display: none;"></div>

        <!-- Submit Button -->
        <button type="submit" class="otp-button" id="submitReviewBtn">
          Submit Review
        </button>
      </form>
    </div>
  </div>

  <script src="../js/services/api.js"></script>
  <script src="../js/pages/user-profile.js"></script>
</body>
</html>
